# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –∏–∑ API

## –ü—Ä–æ–±–ª–µ–º–∞

–î–∞–Ω–Ω—ã–µ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã (—Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, –ø—Ä–æ—Ü–µ–Ω—Ç –∫–æ–º–∏—Å—Å–∏–∏) –Ω–µ –∑–∞–≥—Ä—É–∂–∞–ª–∏—Å—å –∏–∑ API –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–ª–∏—Å—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ.

## –†–µ—à–µ–Ω–∏–µ

### 1. –û–±–Ω–æ–≤–ª–µ–Ω API endpoint `/api/client/referrals/`

–î–æ–±–∞–≤–ª–µ–Ω–æ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ `commission_rate` –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:

```python
# –ö–æ–º–∏—Å—Å–∏—è (–±–µ—Ä–µ–º –∏–∑ –ø–µ—Ä–≤–æ–≥–æ —Ä–µ—Ñ–µ—Ä–∞–ª–∞ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –¥–µ—Ñ–æ–ª—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ 20%)
commission_rate = 20.00
if referrals.exists():
    first_referral = referrals.first()
    if first_referral.commission_rate:
        commission_rate = float(first_referral.commission_rate)

return Response({
    'success': True,
    'referral_link': referral_link,
    'commission_rate': commission_rate,  # –ò–∑ –ë–î
    'stats': {
        'total_referrals': total_referrals,
        'active_referrals': active_referrals,
        'total_earned': float(total_earned),
        'total_paid': float(total_paid),
        'available_balance': available_balance,
    },
    'referrals': referrals_data
})
```

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `loadPartnersData()`

–î–æ–±–∞–≤–ª–µ–Ω–æ:
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- –ó–∞–≥—Ä—É–∑–∫–∞ `commission_rate` –∏–∑ API
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –∫–æ–º–∏—Å—Å–∏–∏ –≤ UI
- –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ API

### 3. –û–±–Ω–æ–≤–ª–µ–Ω HTML

–î–æ–±–∞–≤–ª–µ–Ω—ã ID –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å –∏–∑ API:
- `commissionRateText` - —Ç–µ–∫—Å—Ç —Å –ø—Ä–æ—Ü–µ–Ω—Ç–æ–º –∫–æ–º–∏—Å—Å–∏–∏
- `commissionRateDisplay` - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç–∞ –∫–æ–º–∏—Å—Å–∏–∏ –≤ –±–ª–æ–∫–µ —É—Å–ª–æ–≤–∏–π

### 4. –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —à–∞—Ä–∏–Ω–≥–∞

–§—É–Ω–∫—Ü–∏–∏ `copyReferralLink()`, `shareToTelegram()`, `shareToWhatsApp()`, `shareByEmail()` —Ç–µ–ø–µ—Ä—å:
- –ó–∞–≥—Ä—É–∂–∞—é—Ç —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É –∏–∑ API, –µ—Å–ª–∏ –æ–Ω–∞ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç Clipboard API –∫–∞–∫ fallback
- –û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –æ—à–∏–±–∫–∏

## API Response

```json
{
    "success": true,
    "referral_link": "https://miniapp.expert/?ref=CE84AADD",
    "commission_rate": 20.00,
    "stats": {
        "total_referrals": 0,
        "active_referrals": 0,
        "total_earned": 0.00,
        "total_paid": 0.00,
        "available_balance": 0.00
    },
    "referrals": []
}
```

## –î–∞–Ω–Ω—ã–µ, –∑–∞–≥—Ä—É–∂–∞–µ–º—ã–µ –∏–∑ API

‚úÖ –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ - –∏–∑ `referral_link`  
‚úÖ –ü—Ä–æ—Ü–µ–Ω—Ç –∫–æ–º–∏—Å—Å–∏–∏ - –∏–∑ `commission_rate`  
‚úÖ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ - –∏–∑ `stats.total_referrals`  
‚úÖ –ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ - –∏–∑ `stats.total_earned`  
‚úÖ –î–æ—Å—Ç—É–ø–Ω–æ –∫ –≤—ã–≤–æ–¥—É - –∏–∑ `stats.available_balance`  
‚úÖ –ö–æ–Ω–≤–µ—Ä—Å–∏—è - —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∏–∑ `stats.active_referrals / stats.total_referrals`  
‚úÖ –°–ø–∏—Å–æ–∫ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ - –∏–∑ `referrals`  
‚úÖ –ò—Å—Ç–æ—Ä–∏—è –≤—ã–ø–ª–∞—Ç - –∏–∑ `/api/client/referrals/payouts/`  

## –ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö

–í—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Django API:
- `referrals` —Ç–∞–±–ª–∏—Ü–∞ - —Å–ø–∏—Å–æ–∫ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤
- `referral_commissions` —Ç–∞–±–ª–∏—Ü–∞ - –∫–æ–º–∏—Å—Å–∏–∏
- `referral_payouts` —Ç–∞–±–ª–∏—Ü–∞ - –≤—ã–ø–ª–∞—Ç—ã
- `users.referral_code` - —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –∫–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## –ü—Ä–æ–≤–µ—Ä–∫–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª "–ü–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞"
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:
   - `üîÑ Loading partners data from API...`
   - `üì¶ Referrals API response: ...`
   - `üí∞ Commission rate from API: ...`
   - `‚úÖ Updated referralLink to: ...`
   - `‚úÖ Updated commissionRateText to: ...`

## –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ API  
‚úÖ –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ –ë–î  
‚úÖ –ü—Ä–æ—Ü–µ–Ω—Ç –∫–æ–º–∏—Å—Å–∏–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ –ë–î  
‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ –ë–î  
‚úÖ –°–ø–∏—Å–æ–∫ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ –ë–î  
‚úÖ –ò—Å—Ç–æ—Ä–∏—è –≤—ã–ø–ª–∞—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ –ë–î  
‚úÖ –ù–µ—Ç —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤ HTML  

## –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

1. –û—á–∏—Å—Ç–∏—Ç–µ –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ –Ω–∞ –æ—à–∏–±–∫–∏
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ JWT —Ç–æ–∫–µ–Ω –≤–∞–ª–∏–¥–µ–Ω
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ API endpoint `/api/client/referrals/` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å `referral_code` –≤ –ë–î

