# Интеграция личного кабинета с Django API

## Обзор

Личный кабинет пользователя полностью интегрирован с Django REST Framework API через JWT аутентификацию.

## Структура

### Frontend
- **`site/cabinet.html`** - Страница личного кабинета с современным дизайном
- **`site/cabinet.js`** - JavaScript для работы с Django API
- **`site/login.html`** - Страница входа/регистрации

### Backend API Endpoints

#### Аутентификация
- `POST /api/auth/login/` - Вход пользователя
- `POST /api/auth/register/` - Регистрация пользователя
- `GET /api/auth/profile/` - Получить профиль
- `PATCH /api/auth/profile/` - Обновить профиль

#### Клиентские endpoints
- `GET /api/client/dashboard/` - Дашборд с статистикой
- `GET /api/client/products/` - Список продуктов пользователя
- `GET /api/client/products/available/` - Доступные продукты
- `GET /api/client/orders/` - Список заказов
- `GET /api/client/orders/<id>/` - Детали заказа
- `GET /api/client/payments/` - История платежей
- `GET /api/client/payments/<id>/` - Детали платежа
- `GET /api/client/payment-methods/` - Платежные методы
- `GET /api/client/transactions/` - Все транзакции
- `GET /api/client/referrals/` - Реферальная программа
- `GET /api/client/referrals/payouts/` - История выплат
- `POST /api/client/referrals/request-payout/` - Запрос на вывод

## Аутентификация

### JWT Tokens
- При входе пользователь получает JWT токен
- Токен сохраняется в `localStorage` как `userToken`
- Токен отправляется в заголовке `Authorization: Bearer <token>`

### Защита endpoints
- Все клиентские endpoints требуют аутентификации (`IsAuthenticated`)
- При истечении токена пользователь автоматически перенаправляется на страницу входа

## Функционал личного кабинета

### 1. Мои продукты
- Отображение всех продуктов пользователя
- Статус продукта (активен, истек, ожидает)
- Даты начала и окончания
- Кнопки для управления продуктом

### 2. Мои подписки
- Список активных подписок
- Дата следующего платежа
- Стоимость подписки
- Возможность продления

### 3. История платежей
- Таблица всех платежей
- Статус платежа
- Сумма и дата
- Ссылка на чек (если доступна)
- Общая сумма потраченных средств

### 4. Профиль
- Личные данные (имя, email, телефон)
- Изменение пароля (в разработке)
- Статистика (продукты, подписки, платежи)
- Дата регистрации

### 5. Партнерская программа
- Реферальная ссылка
- Статистика рефералов
- Заработанные средства
- Доступный баланс
- История выплат
- Запрос на вывод средств

## Стиль

Личный кабинет использует тот же стиль, что и главная страница:
- Цвета: `primary: #10B981`, `secondary: #0088CC`
- Шрифт: Inter
- Иконки: Lucide Icons
- Адаптивный дизайн (мобильная версия)

## Развертывание

1. Убедитесь, что Django API запущен и доступен
2. Проверьте настройки CORS в `settings.py`
3. Убедитесь, что все миграции применены
4. Проверьте настройки JWT в `settings.py`

## Тестирование

1. Зарегистрируйте нового пользователя через `/login.html`
2. Войдите в личный кабинет
3. Проверьте загрузку данных из API
4. Проверьте работу всех разделов

## Будущие улучшения

- [ ] Изменение пароля через API
- [ ] Уведомления в реальном времени
- [ ] Экспорт данных
- [ ] Двухфакторная аутентификация
- [ ] Темная тема

